<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Music Events</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.0.1/dist/leaflet.js"></script>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    

  </head>
<body>

<div id="map"></div>

<style>

  body {
    padding: 0px;
    margin: 0px;
  }

  #map,
  body,
  html {
    height: 100%;
  }

</style>

<script type="text/javascript">

var mapbox = "https://api.mapbox.com/styles/v1/suvithala/cjeyil7ri1fbr2so59e01iq3w/tiles/256/{z}/{x}/{y}?" +
              "access_token=pk.eyJ1Ijoic3V2aXRoYWxhIiwiYSI6ImNqZWo2ZDdweDB4OXozM25sbDIyd2I3YTIifQ.rtsx7ta73EbOG-KVPodUpQ"

var myMap = L.map("map", {
    center: [37.09, -95.71],
    zoom: 5,
});   

L.tileLayer(mapbox).addTo(myMap);

Plotly.d3.json("/maps", function (error, response) {
  if (error) return console.warn(error); 
  // eventdata = JSON.parse(response);

  console.log(response);

  var heatArray = [];

  for (var i = 0; i < response.length; i++) {
    heatArray.push([response[i].Latitude, response[i].Longitude])
    }
 
  var heat = L.heatLayer(heatArray, {
    radius: 30,
    blur: 15,
    gradient: {0.0: 'green',
               0.5: 'yellow',
               1.0: 'red'
              },
    minOpacity: 0.7
  }).addTo(myMap)

});

</script>
<script type="text/javascript" src="/static/heatmapmusic.js"></script>
</body>
</html>